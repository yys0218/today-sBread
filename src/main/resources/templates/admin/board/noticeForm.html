<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{admin/adminLayout}">

<head>
  <meta th:name="_csrf" th:content="${_csrf.token}">
  <meta th:name="_csrf_header" th:content="${_csrf.headerName}">
  <link rel="stylesheet" th:href="@{/css/center/notice.css}">
  <link rel="stylesheet" th:href="@{/css/admin/admin.css}">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script th:src="@{/js/comm/sweetalert.noah.js}"></script>
</head>
<div layout:fragment="content">
  <h1 class="nl-title" th:text="${notice == null ? '공지사항 작성' : '공지사항 수정'}"></h1>
  <div class="nf-container">
    <form th:action="${notice == null ? '/admin/board/notice/insert' : '/admin/board/notice/update/' + notice.noticeNo}"
      th:object="${noticeForm}" method="post" id="noticeForm">
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">

      <div class="nf-group">
        <label for="category">카테고리</label>
        <select th:field="*{category}">
          <option value="">-- 선택 --</option>
          <option value="공지">공지</option>
          <option value="점검">점검</option>
          <option value="이벤트">이벤트</option>
          <option value="업데이트">업데이트</option>
        </select>
      </div>

      <div class="nf-group">
        <label for="title">제목</label>
        <input type="text" th:field="*{title}" placeholder="제목을 입력하세요" />
      </div>

      <div class="nf-group">
        <label for="content">내용</label>
        <textarea th:field="*{content}" rows="10" placeholder="내용을 입력하세요"></textarea>
      </div>

      <div class="nf-actions">
        <a th:href="@{/admin/board/notice}">목록으로</a>
        <button type="submit" th:text="${notice == null ? '등록' : '수정'}"></button>
      </div>
    </form>
  </div>
</div>
<th:block layout:fragment="script">
  <script>
    document.getElementById('noticeForm').addEventListener('submit', function (event) {
      event.preventDefault();

      const fieldsToValidate = [
        { id: 'category', message: '카테고리를 선택해주세요.' },
        { id: 'title', message: '제목을 입력해주세요.' },
        { id: 'content', message: '내용을 입력해주세요.' }
      ];

      for (const field of fieldsToValidate) {
        const inputElement = document.getElementById(field.id);
        if (!inputElement.value.trim()) {
          Swal.fire({
            icon: 'warning',
            title: '입력 오류',
            text: field.message,
            confirmButtonText: '확인',
            confirmButtonColor: '#ff6600',
            didClose: () => {
              inputElement.focus({ preventScroll: true });
              inputElement.scrollIntoView({
                behavior: 'auto',
                block: 'center'
              });
            }
          });
          return;
        }
      }
      event.target.submit();
    });
  </script>
  <script th:src="@{/js/admin/admin.js}"></script>
</th:block>

</html>