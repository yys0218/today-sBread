<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{admin/adminLayout}">

<head>
  <meta th:name="_csrf" th:content="${_csrf.token}">
  <meta th:name="_csrf_header" th:content="${_csrf.headerName}">
  <link rel="stylesheet" th:href="@{/css/center/faq.css}">
  <link rel="stylesheet" th:href="@{/css/admin/admin.css}">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script th:src="@{/js/comm/sweetalert.noah.js}"></script>

</head>

<div layout:fragment="content">
  <h2 class="fl-title" th:text="${faq == null ? 'FAQ 작성' : 'FAQ 수정'}"></h2>
  <div class="ff-container">
    <form th:action="${faq == null ? '/admin/board/faq/insert' : '/admin/board/faq/update/' + faq.faqNo}"
      th:object="${faqForm}" method="post" id="faqForm">
      <div th:replace="~{error/formErrors :: formErrorsFragment}"></div>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">

      <div class="ff-group">
        <label for="category">카테고리</label>
        <select th:field="*{category}" id="category">
          <option value="">-- 선택 --</option>
          <option value="회원">회원</option>
          <option value="주문">주문</option>
          <option value="결제">결제</option>
          <option value="배송">배송</option>
          <option value="취소/환불">취소/환불</option>
          <option value="쿠폰/포인트">쿠폰/포인트</option>
          <option value="매장">매장</option>
        </select>
      </div>

      <div class="ff-group">
        <label for="title">질문</label>
        <input type="text" th:field="*{title}" id="title" placeholder="질문을 입력하세요" />
      </div>

      <div class="ff-group">
        <label for="content">답변</label>
        <textarea th:field="*{content}" id="content" rows="10" placeholder="답변 내용을 입력하세요"></textarea>
      </div>

      <div class="ff-actions">
        <a th:href="@{/admin/board/faq}">목록으로</a>
        <button type="submit" th:text="${faq == null ? '등록' : '수정'}"></button>
      </div>
    </form>
  </div>
</div>
<th:block layout:fragment="script">
  <script>
    document.getElementById('faqForm').addEventListener('submit', function (event) {
      event.preventDefault();

      const fieldsToValidate = [
        { id: 'category', message: '카테고리를 선택해주세요.' },
        { id: 'title', message: '제목을 입력해주세요.' },
        { id: 'content', message: '내용을 입력해주세요.' }
      ];

      for (const field of fieldsToValidate) {
        const inputElement = document.getElementById(field.id);
        if (!inputElement.value.trim()) {
          Swal.fire({
            icon: 'warning',
            title: '입력 오류',
            text: field.message,
            confirmButtonText: '확인',
            confirmButtonColor: '#ff6600',
            didClose: () => {
              inputElement.focus({ preventScroll: true });
              inputElement.scrollIntoView({
                behavior: 'auto',
                block: 'center'
              });
            }
          });
          return;
        }
      }

      event.target.submit();
    });
  </script>
  <script th:src="@{/js/admin/admin.js}"></script>
</th:block>

</html>